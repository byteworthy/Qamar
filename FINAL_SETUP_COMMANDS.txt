===============================================
RAILWAY DATABASE SETUP - FINAL COMMANDS
===============================================

You're already authenticated ✅
Now run these commands in PowerShell:

STEP 1: Link to Noor project
-----------------------------
railway link

When prompted:
1. Select "byteworthy's Projects" (press Enter)
2. Select "Noor" (press Enter)

You'll see: "Linked to Noor"


STEP 2: Create tables
--------------------
railway run psql < create-tables.sql

This will:
- Connect to your Railway Postgres
- Execute the SQL to create tables
- Show "CREATE TABLE" messages


STEP 3: Verify
--------------
Open in browser:
https://noor-production-9ac5.up.railway.app/api/health

Should return:
{"status":"healthy","checks":{"database":true,"ai":true}}


ALTERNATIVE (if psql command doesn't work):
------------------------------------------
railway run -- psql -f create-tables.sql

OR run SQL directly:
railway run psql

Then paste these commands:

CREATE TABLE IF NOT EXISTS users (id TEXT PRIMARY KEY, email TEXT, stripe_customer_id TEXT, stripe_subscription_id TEXT, subscription_status TEXT DEFAULT 'free', current_period_end TIMESTAMP, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP);

CREATE TABLE IF NOT EXISTS user_sessions (token TEXT PRIMARY KEY, user_id TEXT NOT NULL, email TEXT, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, expires_at TIMESTAMP NOT NULL);

CREATE TABLE IF NOT EXISTS sessions (id SERIAL PRIMARY KEY, user_id TEXT NOT NULL, thought TEXT NOT NULL, distortions JSONB NOT NULL, reframe TEXT NOT NULL, intention TEXT NOT NULL, practice TEXT NOT NULL, key_assumption TEXT, detected_state TEXT, anchor TEXT, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP);

CREATE TABLE IF NOT EXISTS processed_stripe_events (event_id TEXT PRIMARY KEY, event_type TEXT NOT NULL, processed_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP);

CREATE INDEX IF NOT EXISTS idx_sessions_user_id ON sessions(user_id);
CREATE INDEX IF NOT EXISTS idx_sessions_created_at ON sessions(created_at DESC);

Type \q to exit psql


===============================================
SUCCESS INDICATOR
===============================================

When done, you'll see:
✅ 4 tables in Railway Postgres
✅ Health check returns "database": true
✅ Backend fully operational

Then test mobile app:
npx expo start
